function deleteEvent(e){$("#show-message").modal("hide"),e.preventDefault();var t=$(e.target).attr("data-messagetodelete");showModal("delete-confirmation",t);var a=$("#accept-delete");a.click(function(){a.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span><span class="sr-only">Loading...</span>'),a.attr("disabled","true"),axios.delete("/messages/".concat(t)).then(function(e){a.html("YES"),a.removeAttr("disabled"),closeModal("delete-confirmation"),a.off("click"),$("div[data-idMessage='".concat(t,"']")).remove()}).catch(function(e){console.log(e)}).then(function(){alert("The message has been deleted")})})}function showModal(e,t){axios.get("/messages/data/".concat(t)).then(function(t){$("#editedMessage").val(t.data),$("#".concat(e)).modal("show")})}function closeModal(e){$("#".concat(e)).modal("hide")}function editEvent(e){e.preventDefault(),$("#show-message").modal("hide");var t=$(e.target).attr("data-messagetoedit");showModal("edit-confirmation",t);var a=$("#accept-edit");a.click(function(){a.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span><span class="sr-only">Loading...</span>'),a.attr("disabled","true"),axios.put("/messages/".concat(t),{message:$("#editedMessage").val()}).then(function(e){a.html("YES"),a.removeAttr("disabled"),closeModal("edit-confirmation"),a.off("click"),$("div[data-idMessage='".concat(t,"']")).html(e.data),$("form[data-messagetoedit=".concat(t,"]")).submit(function(e){editEvent(e)}),$("form[data-messagetodelete=".concat(t,"]")).submit(function(e){deleteEvent(e)}),$("form[data-messagetoshow=".concat(t,"]")).submit(function(e){showEvent(e)})}).catch(function(e){console.log(e)}).then(function(){alert("The message has been edited")})})}function showEvent(e){e.preventDefault();var t=$(e.target).attr("data-messagetoshow"),a=$("button[data-showbuttontospinner=".concat(t,"]"));a.attr("disabled","true"),a.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span><span class="sr-only">Loading...</span>'),axios.get("/messages/".concat(t)).then(function(e){a.html('<i title="Show message" class="fas fa-eye" >'),a.removeAttr("disabled"),$("#show-modal-body").empty(),$("#show-modal-body").append(e.data),$("#show-message").modal("show"),$("form[data-messagetoedit=".concat(t,"]")).submit(function(e){editEvent(e)}),$("form[data-messagetodelete=".concat(t,"]")).submit(function(e){deleteEvent(e)})}).catch(function(e){console.log(e)}).then(function(){alert("The message has been showed")})}$(function(){$("#saveForm").submit(function(e){e.preventDefault();var t=$("#send_message");t.attr("disabled","true"),t.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...'),axios.post("/messages/",{room_id:$("#room").attr("data-id-room"),message:quill.root.innerHTML}).then(function(e){t.html("Send message"),t.removeAttr("disabled"),$("#no_replies_alert").hide(),$("#messages").append(e.data),$("form[data-action='delete']").last().submit(function(e){deleteEvent(e)}),$("form[data-action='edit']").last().submit(function(e){editEvent(e)}),$("form[data-action='show']").last().submit(function(e){showEvent(e)}),quill.root.innerHTML=""}).catch(function(e){console.log(e)}).then(function(){alert("The message has been created")})})}),document.addEventListener("DOMContentLoaded",function(){var e=$("#room").attr("data-id-room"),t=10,a=!0;$(window).on("scroll",function(){var n=$(document).height(),o=$(window).height()+$(window).scrollTop();a&&(n-o)/n==0&&($("#spinner_paginate").removeClass("invisible"),axios.get("/rooms/paginateMessages/".concat(e,"/").concat(t)).then(function(e){if(""===e.data){var n=$("<div></div>");n.addClass("alert alert-primary mt-2"),n.attr("id","no_replies_alert"),n.html("<strong>No more replies</strong>"),$("#messages").append(n),a=!1}$("#messages").append(e.data),$("#messages  form[data-action='delete']").slice(t).submit(function(e){deleteEvent(e)}),$("#messages  form[data-action='edit']").slice(t).submit(function(e){editEvent(e)}),$("#messages  form[data-action='show']").slice(t).submit(function(e){showEvent(e)}),t+=10,$("#spinner_paginate").addClass("invisible")}).catch(function(e){console.log(e)}).then(function(){console.log("paginated")}))})}),$(function(){$("form[data-action='delete']").on("submit",function(e){deleteEvent(e)})}),$(function(){$("form[data-action='edit']").on("submit",function(e){editEvent(e)})}),$(function(){$("form[data-action='show']").on("submit",function(e){showEvent(e)})});var toolbarOptions=[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link"]],quill=new Quill("#editor",{modules:{toolbar:toolbarOptions},theme:"snow"});
